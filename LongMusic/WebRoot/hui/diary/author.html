<!DOCTYPE HTML>
<html>
<head>
<title>哆啦日记-不仅仅是怀旧</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="Bookmark" href="/favicon.ico" >
<link rel="Shortcut Icon" href="../../image/logo/dlam.jpg" />
<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5shiv.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="../../css/index1.css">

<link rel="stylesheet" type="text/css" href="../static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="../lib/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/style.css" />
<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<script type="text/javascript" src="js/index1.js"></script>

<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->

</head>
<style type="text/css">
	body {
		background-color: #e2e2e2;
	}
	.contents{
		width: 55%;
		margin-left: 420px;
		margin-top: 30px;
		background:white ;
	}
	.diarys{
	}
	.diary{
		padding: 10px;
		background-color: white;
		padding-bottom: 5px;
		cursor: pointer;
	}
	.diary img{
		width: 20px;
		height: 24px;
		padding: 1px;
	}
	.info{
		color: gray;
		font-size: 10px;
	}
	.zan{
		float:right;
		margin-right: 15px;
	}
	.rights{
		top: 75px;
		left:38px;
		width:356px;
		position:fixed;
		float: right;
		background:white;
		height: 520px;
	}
	.rights img{
		width: 124px;
		height: 180px;
		padding: 1px;
		margin-left:20px;
		margin-top:20px;
		border-radius:5px;
	}
	.rights .perStatistic{
		padding-left: 20px;
		margin-top: 10px;
		padding-bottom: 10px;
	}
	.rights .perInfo{
		padding-left: 20px;
		margin-top: 10px;
		padding-bottom: 10px;
	}
	.rights .activeInfo{
		padding-left: 20px;
		margin-top: 20px;
	}
	.activeInfo span{
		padding-left: 5px;
	}
	.pages{
		vertical-align: middle;
		text-align: center;
		padding-top: 20px;
		padding-bottom: 20px;
	}
	.pages span{
		width:30px;
		height:30px;
		text-align:center;
		line-height:30px;
		display:inline-block;
		background-color:#e2e2e2; 
	}
</style>
<body>
<header class="navbar-wrapper">
	<div class="navbar navbar-fixed-top">
		<div class="container-fluid cl"> <a class="logo navbar-logo f-l mr-10 hidden-xs" href="/aboutHui.shtml">哆啦日记</a> <a class="logo navbar-logo-m f-l mr-10 visible-xs" href="/aboutHui.shtml">Ying</a> 
			<span class="logo navbar-slogan f-l mr-10 hidden-xs">Doranote</span> 
			<a aria-hidden="false" class="nav-toggle Hui-iconfont visible-xs" href="javascript:;">&#xe667;</a>
				<nav id="Hui-userbar" class="nav navbar-nav navbar-userbar hidden-xs">
			<ul class="cl">
				<li id="homepage" style="cursor:pointer;" onclick="openNewPage('1')">首页</li>
				<li class="dropDown dropDown_hover">
					<a href="#" class="dropDown_A"><span id="image">admin</span> <i class="Hui-iconfont">&#xe6d5;</i></a>
					<ul class="dropDown-menu menu radius box-shadow">
						<li><a href="javascript:;" id="myHome" style="display:none" onClick="openNewPage('2')">我的家园</a></li>
						<li><a href="javascript:;" id="write" style="display:none" onClick="openNewPage('3')">写日记</a></li>
						<li><a href="javascript:;" id="alarm" style="display:none" onClick="openNewPage('4')">哆啦闹铃</a></li>
						<li><a href="javascript:;" id="exit" style="display:none" onClick="openNewPage('6')">退出</a></li>
						<li><a class="login" id="login" style="display:block">登录</a></li>
					</ul>
			</li>
				<li id="Hui-msg" class="dropDown right dropDown_hover"> <a href="#" title="消息"><span class="badge badge-danger" id="unReadNum"></span><i class="Hui-iconfont" style="font-size:18px">&#xe68a;</i></a> 
					<ul class="dropDown-menu menu radius box-shadow">
						<li><a href="javascript:;" data-val="red" title="公告数目">公告<font color="red"><span id="advNum"></span></font></a></li>
						<li><a href="javascript:;" data-val="default" title="评论数目">评论<font color="red"><span id="comNum"></span></font></a></li>
						<li><a href="javascript:;" data-val="blue" title="获赞数目">获赞<font color="red"><span id="praiseNum"></span></font></a></li>
						<li><a href="javascript:;" data-val="green" title="关注数目">关注<font color="red"><span id="noticeNum"></span></font></a></li>
						<li><a href="javascript:;" data-val="yellow" title="点击后消息标记为已读" id="cleanBtn" style="display:none" onclick="setAsReaded()">朕已阅✔</a></li>
						<li><a href="javascript:;" data-val="yellow" title="消息设置">设置</a></li>
					</ul>
				</li>
				<li id="Hui-skin" class="dropDown right dropDown_hover"> <a href="javascript:;" class="dropDown_A" title="换肤"><i class="Hui-iconfont" style="font-size:18px">&#xe62a;</i></a>
					<ul class="dropDown-menu menu radius box-shadow">
						<li><a href="javascript:;" data-val="default" title="默认（黑色）">默认（黑色）</a></li>
						<li><a href="javascript:;" data-val="blue" title="蓝色">蓝色</a></li>
						<li><a href="javascript:;" data-val="green" title="绿色">绿色</a></li>
						<li><a href="javascript:;" data-val="red" title="红色">红色</a></li>
						<li><a href="javascript:;" data-val="yellow" title="黄色">黄色</a></li>
						<li><a href="javascript:;" data-val="orange" title="橙色">橙色</a></li>
					</ul>
				</li>
			</ul>
		</nav>
	</div>
</div>
</header>

<div class="modal fade" id="loginModal" style="display:none;">
			<div class="modal-dialog modal-sm" style="width:540px;">
				<div class="modal-content" style="border:none;">
					<div class="col-left"></div>
					<div class="col-right">
						<div class="modal-header">
							<button type="button" id="login_close" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
							<h4 class="modal-title" id="loginModalLabel" style="font-size: 18px;">登录</h4>
						</div>
						<div class="modal-body">
							<section class="box-login v5-input-txt" id="box-login">
								<form id="login_form" name="login_form" action="" method="post" autocomplete="off">
									
									<ul>
										<li class="form-group"><input class="form-control" id="id_account_l" maxlength="50" name="account_l" placeholder="请输入邮箱账号/手机号" type="text"></li>
										<li class="form-group"><input class="form-control" id="id_password_l" name="password_l" placeholder="请输入密码" type="password"></li>
									</ul>
								</form>
								<p class="good-tips marginB10"><a id="btnForgetpsw" class="fr">忘记密码？</a>还没有账号？<a href="javascript:;" target="_blank" id="btnRegister">立即注册</a></p>
								<div class="login-box marginB10">
									<button id="login_btn" type="button" onclick="login()" class="btn btn-micv5 btn-block globalLogin">登录</button>
									<div id="login-form-tips" class="tips-error bg-danger" style="display: none;">错误提示</div>
								</div>
<!-- 								<div class="threeLogin"><span>其他方式登录</span><a class="nqq" href="javascript:;"></a><a class="nwx" href="javascript:;"></a><a class="nwb"></a></div>
 -->							</section>
						</div>
					</div>
				</div>
			</div>
		</div>	

<div class="contents">
	<div class="pages" style="cursor: pointer;">
	</div>
	<div class="diarys" id="diarys">
		<div class="diary" >
			我是内容<br>
			LongBro	2019-10-12 23:00:52 星期六 |《我又想你了》  广东省广州市
			<div class="zan">
				<i class="Hui-iconfont">&#xe725;</i>2000&nbsp;
				<i class="Hui-iconfont">&#xe622;</i>66&nbsp;
				<i class="Hui-iconfont">&#xe66d;</i>8
			</div>
		</div>
	</div>
	<div class="pages" style="cursor: pointer;">
	</div>
</div>

<div class="rights">
		<img src='../../image/logo/dlam.jpg' class='touxiang'>
		<button id="attention" onclick="attenAuthor()"></button>

	<div class="perStatistic">
		关注：<span title="她关注的人" id="careNum">0</span>&emsp;粉丝：<span title="关注她的人" id="noticedNum">0</span>&emsp;
		喜欢：<span title="她喜欢的日记" id="likeNum">0</span>&emsp;收藏：<span title="她收藏的日记" id="storeNum">0</span><br>	
		被阅读量：<span title="她的日记总被阅读量" id="visitedNum">0</span>&emsp;阅读量：<span title="她的阅读量" id="visitNum">0</span>&emsp;被评论数：<span title="她的日记总被评论量" id="comedNum">0</span>
		&emsp;被赞：<span title="她的日记总被赞数量" id="praisedNum">0</span>
	</div>
	<hr>
	<div class="perInfo">
		<span id="userNameT">LongBro</span><br>
		昵称：<span id="userName">LongBro</span><br>
		哆啦ID：<span id="userId">88888888</span><br>
		家歌：<span id="homeSong">四块五</span><br>
		性别：<span id="sex">男</span><br>
		个性签名：<span id="signature">自先沉稳，而后爱人</span><br>
	</div>
	<hr>
	<div class="activeInfo">
		<i class="Hui-iconfont">&#xe690;</i><span id="joinTime">加入时间：2019.09.28 11:26</span><br>
		<i class="Hui-iconfont">&#xe690;</i><span id="recentLogin">最近登录：2019.09.28 11:26</span><br>
	</div>
</div>
<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="../lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="../lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="../static/h-ui/js/H-ui.min.js"></script>
<script type="text/javascript" src="../static/h-ui.admin/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="../lib/jquery.contextmenu/jquery.contextmenu.r2.js"></script>
<script type="text/javascript">
function GetQueryString(name)
{
     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
     var r = window.location.search.substr(1).match(reg);
     if(r!=null)return  unescape(r[2]); return null;
}
$(".login").on("click", login_popup),function() {
    var e = [];
    $(".modal").on("show.bs.modal",
    function() {
        for (var s = 0; e.length > s; s++) e[s] && (e[s].modal("hide"), e[s] = null);
        e.push($(this));
        var o = $(this),
        a = o.find(".modal-dialog"),
        t = $('<div style="display:table; width:100%; height:100%;"></div>');
        t.html('<div style="vertical-align:middle; display:table-cell;"></div>'),
        t.children("div").html(a),
        o.html(t)
    })
} ();
var author=GetQueryString("author");//被查看的用户
var user=getCookie("userId")+"";//当前登录用户
$(function(){
	getUser();
	loadAuthorInfo();
	setPage(author,perPage);
	loadDiary(author,1,perPage);
	ifAttention();
});

/*根据作者加载日记*/
function loadDiaryByAuthor(author,page){
	$("#diarys").text("");
	$.ajax({
		url:"../../note/diary/getDiaryBy.do",
		type:"get",
		async:false,
		dataType:"Json",
		data:{
			author:author,
			page:page
		},
		success:function(data){
			for(var i=0;i<data.length;i++){
				//处理内容和标题
				var title=data[i].ntitle+"";
				var con=handleCon(data[i].ncontent);
				console.log(con);

				if(con.length>250){
					con=con.substring(0,250)+"...";
				}
				if(title.length>10){
					title=title.substring(0,8)+"...";
				}
				//分类
				var cate=getCateById(data[i].ntype);
				$("#diarys").append("<div class=\"diary\"><span onclick='openOther(0,"+data[i].nid+")'>&emsp;&emsp;"+con+"</span><br>"
						+"<div class='info'>&emsp;<i class=\"Hui-iconfont\">&#xe690;</i>"+data[i].ntime
						+"&emsp;<i class=\"Hui-iconfont\">&#xe681;</i>"+cate+"&nbsp;:<span title='"+data[i].ntitle+"'>《"+title+"》</span>&emsp;<i class=\"Hui-iconfont\">&#xe6c9;</i>"+data[i].nlocation+""
						+"<div class='zan'><i class=\"Hui-iconfont\">&#xe725;</i>2019&nbsp;<i class=\"Hui-iconfont\">&#xe622;</i><span id='commentNum'>"+data[i].commentNum+"</span>&nbsp;<i class=\"Hui-iconfont\">&#xe66d;</i><span>"+data[i].praiseNum+"</span>&nbsp;<i class=\"Hui-iconfont\">&#xe66e;</i>8&nbsp;<i class=\"Hui-iconfont\">&#xe630;</i><span>"+data[i].storeNum+"</span></div></div>"
						+"</div><hr width='740px'>");
			}
		}
	});
	curPage=parseInt(page);
	setPage();
}
/*打开其他的界面：作者、某日记*/
function openOther(type,value){
	if(type==0){
		window.open("diary.html?id="+value, "_blank")
	}else if(type==1){
		window.open("author.html?author="+value, "_blank")
	}
}
//判断是否当前登录用户是否已关注当前作者
function ifAttention(){
	if(user==author){//当前登录用户查看自己时，不显示关注、已关注
		return;
	}
	var ifAtt=0;//0表示未关注
	$.ajax({
		url:"../../note/notice/whetherHasNotice.do",
		type:"get",
		async:false,
		data:{
			NNoticer:user,
			NNoticed:author
		}, 
		dataType:"Json",
		success:function(data){

			if(data.code==200){
				ifAtt=1;
			}
		}
	});
	var attBtn=document.getElementById("attention");
	if(ifAtt==1){//已关注，则隐藏“关注”按钮
		attBtn.innerHTML="已关注<i class=\"Hui-iconfont\">&#xe676;</i>";
	}else{
		attBtn.innerHTML="关注<i class=\"Hui-iconfont\">&#xe716;</i>";
	}
}

function attenAuthor(){
	var attBtn=document.getElementById("attention");
	var fanNum=document.getElementById("noticedNum");//粉丝数
	var text=attBtn.innerHTML+"";
	var url="";//
	if(text.indexOf("已关注")!=-1){//已关注情况取消关注
		url="../../note/notice/cancelAtten.do";
		attBtn.innerHTML="关注<i class=\"Hui-iconfont\">&#xe716;</i>";
		fanNum.innerText=parseInt(fanNum.innerText)-1;
	}else{
		url="../../note/notice/noticeAuthor.do";
		attBtn.innerHTML="已关注<i class=\"Hui-iconfont\">&#xe676;</i>";
		fanNum.innerText=parseInt(fanNum.innerText)+1;
	}
	$.ajax({
		url:url,
		type:"get",
		async:false,
		data:{
			NNoticer:user,
			NNoticed:author
		}, 
	});
}
</script> 
</body>
</html>